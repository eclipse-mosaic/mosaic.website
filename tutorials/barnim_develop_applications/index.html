<!DOCTYPE html><html lang="en-us" >




  


<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-Security-Policy" content="
    upgrade-insecure-requests;
    base-uri        'self';
    default-src     'none';
    object-src      'none';
    script-src      'self' 'unsafe-inline' 'unsafe-eval' https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev https://code.jquery.com https://cdn.jsdelivr.net https://maps.google.com https://cse.google.com ;
    worker-src      'self'                               https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev https://code.jquery.com https://cdn.jsdelivr.net https://maps.google.com https://cse.google.com ;
    style-src       'self' 'unsafe-inline'               https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev https://cdn.jsdelivr.net ;
    img-src         'self' data:                         https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev ;
    media-src       'self' data:                         https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev ;
    font-src        'self' data:                         https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev ;
    child-src                                            https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev https://*.dcaiti.com https://dcaiti.com https://cse.google.com ;
    connect-src                                          https://*.dcaiti.tu-berlin.de https://eclipse.dev https://www.eclipse.dev http://localhost:1313/ ws://localhost:1313/ ;
    manifest-src    'self'                               https://*.dcaiti.tu-berlin.de https://maps.google.com https://cse.google.com https://play.google.com ;
    frame-ancestors 'self';
    ">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
      
    
    
    
    
  
  

  <meta name="author" content="Fraunhofer FOKUS">

  
  
  
    
  
  <meta name="description" content="">

  
  <link rel="alternate" hreflang="en-us" href="https://www.eclipse.dev/mosaic/tutorials/barnim_develop_applications/">

  


  
  
  
  
  
  <meta name="theme-color" content="#68145C">
  

  
  
  
  <script src="/mosaic/js/mathjax-config.js"></script>
  

  
  
  
  
  
    <link rel="stylesheet" href="https://www.eclipse.dev/mosaic/css/thirdparty/academicons.min.css">
    <link rel="stylesheet" href="https://www.eclipse.dev/mosaic/css/thirdparty/font-awesome.all.min.css">
    <link rel="stylesheet" href="https://www.eclipse.dev/mosaic/css/thirdparty/jquery.fancybox.min.css">
  

  
  
  
    
  
  
    <link rel="stylesheet" href="https://www.eclipse.dev/mosaic/css/thirdparty/highlight.min.css">
  


  
    
      <link rel="stylesheet" href="https://www.eclipse.dev/mosaic/css/thirdparty/leaflet.css">
    
  

  

  
  
  
    
  
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
      
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/lazysizes.min.js"></script>
      
    
  
    

    
    

    
  
    

    
    

    
  
    

    
    

    
      
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/tex-chtml.min.js"></script>
      
    
  
    

    
    

    
  
    

    
    

    
  

  
  
  
  
  <link rel="stylesheet" href="/mosaic/css/academic.css">

  




  


  
  

  
  <link rel="alternate" href="/mosaic/tutorials/barnim_develop_applications/index.xml" type="application/rss+xml" title="Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility">
  

  <link rel="manifest" href="/mosaic/index.webmanifest">
  <link rel="icon" type="image/png" href="/mosaic/images/icon_hu6bdfb97c7e23190c70e41ca0e15a9fce_30436_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/mosaic/images/icon_hu6bdfb97c7e23190c70e41ca0e15a9fce_30436_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.eclipse.dev/mosaic/tutorials/barnim_develop_applications/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility">
  <meta property="og:url" content="https://www.eclipse.dev/mosaic/tutorials/barnim_develop_applications/">
  <meta property="og:title" content="Barnim: Develop Applications | Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility">
  <meta property="og:description" content=""><meta property="og:image" content="https://www.eclipse.dev/mosaic/images/logo.svg">
  <meta property="twitter:image" content="https://www.eclipse.dev/mosaic/images/logo.svg"><meta property="og:locale" content="en-us">
  
    
  

  




  


  





  <title>Barnim: Develop Applications | Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class=" page-mosaic page-tutorials page-barnim_develop_applications ">

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-10 col-md-3">
          <div class="logo" style="background-image: url(/mosaic/img/logos/mosaic/EclipseMOSAIC-Logo-RGB-positiv.svg)"></div>
        </div>
        <div class="col-2 col-md-4 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  



  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    <div class="d-none d-lg-inline-flex">
      <a style="visibility:visible;" class="navbar-brand" href="/mosaic/"><img src="/mosaic/images/logo.svg" alt="Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility"></a>
    </div>


    
    <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-content-mobile" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/mosaic/"><img src="/mosaic/images/logo.svg" alt="Eclipse MOSAIC – A Multi-Domain and Multi-Scale Simulation Framework for Connected and Automated Mobility"></a>
    </div>
    

    
    
    <div id="navbar-content" class="navbar-collapse main-menu-item collapse justify-content-start">

    
    <ul class="navbar-nav d-md-inline-flex">
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/about/"><span>About</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/news/"><span>News</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/docs/"><span>Documentation</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link  active" href="/mosaic/tutorials/"><span>Tutorials</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/workshops/"><span>Workshops</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/download/"><span>Download</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/commercial/"><span>Commercial</span></a>
      </li>

      
      

      

      
      
      
      
      

      
      
      
      
      
      

      <li class="nav-item">
        <a class="nav-link " href="/mosaic/community/"><span>Community</span></a>
      </li>

      
      

      

      
    </ul>
  </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      
      <li class="nav-item ">
        <a href="https://github.com/eclipse-mosaic/mosaic" target="blank">
          <i class="fab fa-github" aria-hidden="true"></i>
        </a>
      </li>
      

      

    </ul>

    
    
    <div id="navbar-content-mobile" class="navbar-collapse main-menu-item collapse justify-content-start d-lg-none">

    
      <ul class="navbar-nav d-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/about/"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/news/"><span>News</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/docs/"><span>Documentation</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/mosaic/tutorials/"><span>Tutorials</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/workshops/"><span>Workshops</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/download/"><span>Download</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/commercial/"><span>Commercial</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/mosaic/community/"><span>Community</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

  </div>
</nav>


  












  

  
  
  
    
  
<div class="universal-wrapper pt-3">
  <h1>Barnim: Develop Applications</h1>

  

  
</div>



<div class="universal-wrapper">
  
  <div class="article-style"><div class="alert alert-note">
  <div>
<p>All files you need for this tutorial are included in the Eclipse MOSAIC zip file:<br>
<strong>





  
  

    

    
    
      
      
      
      
    

    
    

    
  

<a href="/mosaic/download/">Download Eclipse MOSAIC</a></strong></p>
  </div>
</div>
<p>The <strong>Barnim: Develop Applications</strong> tutorial extends the preceding tutorial and focuses on the implementation of applications
used in the Barnim scenario. In this section, the actual source code used to create the applications is explained,
giving a first impression on the API of the <strong>Eclipse MOSAIC Application</strong> simulator.</p>
<div class="alert alert-learning_objectives">
  <div>
  <h3>Learning Objectives</h3>
<p>After completing this tutorial you will be able to:</p>
<ul>
<li>
<p>Develop Applications for simulation entities.</p>
</li>
<li>
<p>Transmit and receive V2X-messages periodically or on request depending on the network type and communication mode (
e.g. topologically-scoped unicast, geographically-scoped broadcast, etc.).</p>
</li>
<li>
<p>Calculate alternative routes to the destination to circumnavigate a road obstacle.</p>
</div>
</li>
</ul>
</div>
<p>As mentioned in 





  
  

    

    
    
      
      
      
      
    

    
    

    
  

<a href="/mosaic/tutorials/barnim_simulation_basics/#overview-of-applications">Barnim: Simulation Basics</a>, the Barnim
tutorial is structured in four applications.</p>
<ol>
<li>





  
  

<a href="#slowdownapp"><code>SlowDownApp</code></a> - Models driver behavior by slowing the vehicle down as soon as it enters an affected road segment.</li>
<li>





  
  

<a href="#weatherwarningapp"><code>WeatherWarningApp</code></a> - Detects bad road conditions, broadcasts information via ad-hoc communication, circumnavigates areas with bad road conditions.</li>
<li>





  
  

<a href="#weatherwarningappcell"><code>WeatherWarningAppCell</code></a> - Uses cellular communication and receives messages from <code>WeatherServerApp</code>. Circumnavigates areas with bad road conditions.</li>
<li>





  
  

<a href="#weatherserverapp"><code>WeatherServerApp</code></a> - Broadcasts information about bad road conditions via cellular communication.</li>
</ol>
<h2 id="general-application-structure">General application structure</h2>
<p>Applications can be mapped to various simulation entities, such as vehicles, servers, or traffic lights. The most basic structure for an application mapped onto a vehicle looks like the following:</p>
<pre><code class="language-java">public class ExampleApp extends AbstractApplication&lt;VehicleOperatingSystem&gt; implements VehicleApplication {   
 
    @Override 
    public void onStartup() { 
    } 
    
    @Override 
    public void onVehicleUpdated(VehicleData previousVehicleData, VehicleData updatedVehicleData) {  
    }
     
    @Override  
    public void processEvent(Event event){     
    }   
      
     @Override 
     public void onShutdown() {
     }   
}  
</code></pre>
<p><code>onVehicleUpdated</code> needs to be defined and overwritten in order to successfully implement the interface <code>VehicleApplication</code>.
<code>processEvent</code> handles all events that get called to the application specific event manager, like this:</p>
<pre><code class="language-java">getOs().getEventManager().addEvent(new Event(getOs().getSimulationTime(), this));  
</code></pre>
<p>Some examples of events are shown below, but a more detailed description can be found in the






  
  

    

    
    
      
      
      
      
    

    
    

    
  

<a href="/mosaic/docs/develop_applications/event_scheduling/">documentation</a>.</p>
<h2 id="slowdownapp">SlowDownApp</h2>
<p>The 




<a href="https://github.com/eclipse-mosaic/mosaic/blob/main/app/tutorials/weather-warning/src/main/java/org/eclipse/mosaic/app/tutorial/SlowDownApp.java" target="_blank" rel="noopener"><code>SlowDownApp</code></a> induces a speed reduction as soon as the on-board sensors detect hazardous conditions.
To detect the change in the on-board sensors, the state of the sensors have to be queried whenever the
vehicle has moved. This is achieved by implementing the <code>onVehicleUpdated()</code> method which is called
whenever the traffic simulator executed one simulation step.</p>
<p>In this specific implementation, the speed of the vehicle is reduced to <em>25 km/h</em> within the entire hazardous area.
After leaving the hazardous area, the vehicles returns to their original speed again:</p>
<pre><code class="language-java">
private final static float SPEED = 25 / 3.6f;

private boolean inHazardousArea = false;

@Override
public void onStartup() {
    getOs().getBasicSensorModule().enable();
}

@Override
public void onVehicleUpdated(VehicleData previousVehicleData, VehicleData updatedVehicleData) {
    
    SensorType[] types = SensorType.values();
    int strength = 0;
    
    for (SensorType currentType : types) {
        strength = getOs().getBasicSensorModule().getStrengthOf(currentType);
    
        if (strength &gt; 0) {
            break;
        }
    }
    
    if (strength &gt; 0 &amp;&amp; !inHazardousArea) {
        getOs().changeSpeedWithInterval(SPEED, 5000);
        inHazardousArea = true;
    }
    
    if (strength == 0 &amp;&amp; inHazardousArea) {
        getOs().resetSpeed();
        inHazardousArea = false;
    }
}
</code></pre>
<h2 id="weatherwarningapp">WeatherWarningApp</h2>
<p>The 




<a href="https://github.com/eclipse-mosaic/mosaic/blob/main/app/tutorials/weather-warning/src/main/java/org/eclipse/mosaic/app/tutorial/WeatherWarningApp.java" target="_blank" rel="noopener"><code>WeatherWarningApp</code></a> application illustrates the vehicles and their behaviour in particular with regard to the
detecting hazardous area, the receiving and sending messages. We will also cover how alternative routes
will be calculated and how vehicles change their route in order to circumnavigate the affected road area.</p>
<p>The simulating vehicles can be operated as Cellular or Ad-hoc equipped. Accordingly, the kind of used communication
network will be activated in the <code>onStartup()</code> method as following:</p>
<pre><code class="language-java">public void onStartup() {
    getLog().infoSimTime(this, &quot;Initialize application&quot;);
    if (useCellNetwork()) {
        getOs().getCellModule().enable();
        getLog().infoSimTime(this, &quot;Activated Cell Module&quot;);
    } else {
        getOs().getAdHocModule().enable(new AdHocModuleConfiguration()
            .addRadio()
                .channel(AdHocChannel.CCH)
                .power(50)
                .create());
        getLog().infoSimTime(this, &quot;Activated AdHoc Module&quot;);
    }
    
    getOs().requestVehicleParametersUpdate()
            .changeColor(Color.RED)
            .apply();
}
</code></pre>
<p>In case the sensor detects an environmental hazard the vehicle sends out a DEN-message to warn
other vehicles. In the <code>reactOnEnvironmentData()</code> method, the sending is handled with
regard to used communication network. For the <code>WeatherWarningApp</code>,  ITS-G5 communication is used
to inform all vehicles in reach. In case of the <code>WeatherWarningAppCell</code>, the environment event is
sent as a DEN-message directly to the server entity which runs the <code>EmergencyServerApp</code>, addressed
by the name of the unit (i.e., <code>server_0</code>).</p>
<pre><code class="language-java">private void reactOnEnvironmentData(SensorType type, int strength) {

    GeoPoint vehiclePosition = getOs().getPosition();
    
    String roadId = getOs().getVehicleInfo().getRoadPosition().getConnection().getId();
    
    // reach all vehicles in a 3000m radius
    GeoCircle dest = new GeoCircle(vehiclePosition, 3000);
    
    MessageRouting mr;
    if (useCellNetwork()) {
        mr = getOs().getCellModule().createMessageRouting()
                .destination(&quot;server_0&quot;)
                .topological()
                .build();
    } else {
        mr = getOs().getAdHocModule().createMessageRouting()
                .broadcast()
                .geographical(dest)
                .build();
    }
    
    Denm denm = new Denm(mr, new DENMContent(
        getOs().getSimulationTime(), vehiclePosition, roadId, type, strength, SPEED, 0.0f, vehiclePosition, null, null)
    );
    
    if (useCellNetwork()) {
        getOs().getCellModule().sendV2XMessage(denm);
    } else {
        getOs().getAdHocModule().sendV2XMessage(denm);
    }
}
</code></pre>
<p>Next, we look at the receiving side of the DENM here. Since the message is a simple V2X message it
is received through the <code>receiveV2xMessage()</code>-method which is part of the application interface.
Analogous to a normal message, here we check with <code>instanceof</code>, if it is of a type that we are interested in, in
this case <code>Denm</code>. In that very case, we perform a potential route change if not already done.</p>
<pre><code class="language-java">public void receiveV2xMessage(ReceivedV2xMessage receivedV2xMessage) {
    final V2xMessage msg = receivedV2xMessage.getMessage();
    if (!(msg instanceof Denm)) {
        return;
    }
    
    final Denm denm = (Denm)msg;
    if (routeChanged) {
        getLog().infoSimTime(this, &quot;Route already changed&quot;);
    } else {
        reactUponDENMessageChangeRoute(denm);
    }
}
</code></pre>
<p>In order to calculate alternative routes to the destination and to change the actual route to the next best route,
the method <code>circumnavigateAffectedRoad()</code> is implemented. The affected road segment is identified by the road id parameter.
The route calculation needs to be parametrized in a way, that it avoids this road segment to include in the calculation.
This is achieved by using the specific cost function <code>ReRouteSpecificConnectionsCostFunction</code> and passing it
to the <code>RoutingParameters</code> object.</p>
<pre><code class="language-java">private void circumnavigateAffectedRoad(DENM denm, final String affectedRoadId) {

    ReRouteSpecificConnectionsCostFunction myCostFunction = new ReRouteSpecificConnectionsCostFunction();
    myCostFunction.setConnectionSpeedMS(affectedRoadId, denm.getCausedSpeed());
    
    NavigationModule navigationModule = getOs().getNavigationModule();
    
    RoutingParameters routingParameters = new RoutingParameters().costFunction(myCostFunction);
    
    RoutingResponse response = navigationModule.calculateRoutes(new RoutingPosition(navigationModule.getTargetPosition()), routingParameters);
    
    CandidateRoute newRoute = response.getBestRoute();
    if (newRoute != null) {
        getLog().infoSimTime(this, &quot;Sending Change Route Command at position: {}&quot;, denm.getSenderPosition());
        navigationModule.switchRoute(newRoute);
    }
}
</code></pre>
<h2 id="weatherwarningappcell">WeatherWarningAppCell</h2>
<p>The 




<a href="https://github.com/eclipse-mosaic/mosaic/blob/main/app/tutorials/weather-warning/src/main/java/org/eclipse/mosaic/app/tutorial/WeatherWarningAppCell.java" target="_blank" rel="noopener"><code>WeatherWarningAppCell</code></a> extends the previously presented <code>WeatherWarningApp</code> by using communication
via a cellular network instead of ad-hoc based communication. In that case, DENM are not
sent to vehicles directly, but to the <strong>WeatherServer</strong> (addressed by name <code>server_0</code>), which then will
re-broadcast received DENM to all cell-connected vehicles in the near of the hazardous area.</p>
<h2 id="weatherserverapp">WeatherServerApp</h2>
<p>The 




<a href="https://github.com/eclipse-mosaic/mosaic/blob/main/app/tutorials/weather-warning/src/main/java/org/eclipse/mosaic/app/tutorial/WeatherServerApp.java" target="_blank" rel="noopener"><code>WeatherServerApp</code></a> is mapped to a server simulation unit without geographical location which receives knowledge about the hazardous area via DEN-messages
and it is responsible to re-transmit those DEN-Messages periodically to vehicles equipped with <code>WeatherWarningAppCell</code>-application via
cellular communication. Firstly, the interval for re-transmitting the last received DEN-message will be defined:</p>
<pre><code class="language-java"> /**
 * Send warning at this interval, in seconds.
 */
private final static long INTERVAL = 2 * TIME.SECOND;


/**
 * Save the last received DEN message for relaying.
 */
private Denm lastReceivedDenm = null;
</code></pre>
<p>During the initialization procedure of communicating applications, the communication module (CellModule) needs to be
activated. This is achieved in the <code>onStartup()</code>-method. The following code snippet shows the activating the
CellModule as communication mode:</p>
<pre><code class="language-java">public void onStartup() {
    getLog().infoSimTime(this, &quot;Initialize WeatherServer application&quot;);
    getOperatingSystem().getCellModule().enable();
    sample();
}
</code></pre>
<p>In order to re-transmit the last received DENM, we need to capture all received V2X messages and store the last received DENM.
This is achieved by implementing the <code>onMessageReceived</code> method.</p>
<pre><code class="language-java">@Override
public void onMessageReceived(ReceivedV2xMessage receivedV2xMessage) {
    final V2xMessage msg = receivedV2xMessage.getMessage();
    
    // Only DEN Messages are handled
    if (msg instanceof Denm) {
        lastReceivedDenm = (Denm) msg;
    }
}
</code></pre>
<p>The last received DENM will then be re-transmitted in <strong>2s</strong> intervals (as configured above) to the vehicles equipped with cellular
communication within reach as an event;</p>
<pre><code class="language-java">private void sample() {
    if (lastReceivedDenm != null) {        
        final Denm denm = constructDenm();
        getOs().getCellModule().sendV2xMessage(denm);
    }
    getOs().getEventManager().addEvent(getOs().getSimulationTime() + INTERVAL, this);
}
</code></pre>
<p>The <code>Event</code> created in this method is passed with a <code>this</code> argument, which represents an <code>EventProcessor</code> that gets notified
as soon as the proposed event time is reached. As this class implements the <code>EventProcessor</code> interface, the method
<code>processEvent()</code> will be called by the application simulator once the simulation time is reached:</p>
<pre><code class="language-java">@Override
public void processEvent(Event event) throws Exception {
    sample();
}
</code></pre>
<p>Finally, in the method <code>contructDenm</code>, a new DENM object will be created for transmitting, by copying
the <code>DenmContent</code> of the last received DENM. Furthermore, we create a circular area for the rerouting (3000 m)
of the DEN-Message as Broadcast. All vehicles within this area which have the cellular module activated, will
receive this message.</p>
<pre><code class="language-java">private Denm constructDenm() {
    final MessageRouting routing = getOs().getCellModule().createMessageRouting()
            .broadcast()
            .geographical(new GeoCircle(lastReceivedDenm.getEventLocation(), 3000.0))
            .build();
    return new Denm(routing,
            new DenmContent(
                    lastReceivedDenm.getTime(),
                    lastReceivedDenm.getSenderPosition(),
                    lastReceivedDenm.getEventRoadId(),
                    lastReceivedDenm.getWarningType(),
                    lastReceivedDenm.getEventStrength(),
                    lastReceivedDenm.getCausedSpeed(),
                    lastReceivedDenm.getSenderDeceleration(),
                    lastReceivedDenm.getEventLocation(),
                    lastReceivedDenm.getEventArea(),
                    lastReceivedDenm.getExtendedContainer()
            ),
            200
    );
}
</code></pre>
</div>
  

  
  

  

  
  <div class="post-nav prev-next-pages col-12">
    <div class="row">

      
      <div class="post-nav-item col-12 col-md-6">
        
          <div class="meta-nav">Previous</div>
          <a href="/mosaic/tutorials/barnim_simulation_basics/" rel="next">Barnim: Simulation Basics</a>
        
      </div>

      
      <div class="post-nav-item col-12 col-md-6 align-self-end">
        
          <div class="meta-nav">Next</div>
          <a href="/mosaic/tutorials/create_new_scenario/" rel="next">Create a new Scenario</a>
        
      </div>

    </div>
  </div>


  

</div>

      

    
    
    

    

    
      <script src="https://www.eclipse.dev/mosaic/js/thirdparty/jquery.min.js"></script>
      <script src="https://www.eclipse.dev/mosaic/js/thirdparty/popper.min.js"></script>
      <script src="https://www.eclipse.dev/mosaic/js/thirdparty/imagesloaded.pkgd.min.js"></script>
      <script src="https://www.eclipse.dev/mosaic/js/thirdparty/isotope.pkgd.min.js"></script>
      <script src="https://www.eclipse.dev/mosaic/js/thirdparty/jquery.fancybox.min.js"></script>

      
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/mermaid.min.js"></script>
      

      
        
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight.min.js"></script>
        
          <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight-java.min.js"></script>
        
          <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight-json.min.js"></script>
        
          <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight-xml.min.js"></script>
        
          <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight-shell.min.js"></script>
        
          <script src="https://www.eclipse.dev/mosaic/js/thirdparty/highlight-dos.min.js"></script>
        
      
    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/mosaic/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    
    
    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
      
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/fuse.min.js"></script>
        <script src="https://www.eclipse.dev/mosaic/js/thirdparty/jquery.mark.min.js"></script>
      
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script type="application/javascript" src="/mosaic/js/academic.min.27a6ec9020f3e0fadc470c962ab49eb9.js"></script>

    

<script type="application/javascript" src="/mosaic/js/mosaic-wg-cards.js"></script>
<script type="application/javascript" src="/mosaic/js/mosaic-docs.js"></script>




    <script>
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new window.bootstrap.Tooltip(tooltipTriggerEl)
      })
    </script>


  
  
  <div class="footer-wrap">
    <div class="container">
      <footer class="site-footer">
  <div class="row">
  
    
      <div class="col-sm-4 mb-3 mb-md-0">
        <b>Eclipse MOSAIC</b>
        
          <ul>
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/download/" title="Download Eclipse MOSAIC" >
                    
                      Download Eclipse MOSAIC
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/docs/" title="Documentation" >
                    
                      Documentation
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/tutorials/" title="Tutorials" >
                    
                      Tutorials
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/workshops/" title="Workshops" >
                    
                      Workshops
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/about/#license" title="License" >
                    
                      License
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/community/#projects" title="Projects" >
                    
                      Projects
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/publications/" title="Publications" >
                    
                      Publications
                    
                    
                  </a>
                </li>
              
            
          </ul>
        
      </div>
    
  
    
      <div class="col-sm-4 mb-3 mb-md-0">
        <b>Community</b>
        
          <ul>
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/community/" title="Eclipse MOSAIC Community" >
                    
                      Eclipse MOSAIC Community
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/contribution/" title="How to contribute" >
                    
                      How to contribute
                    
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://github.com/eclipse-mosaic/mosaic" title="Github"  target="_blank" rel="noopener">
                    
                      Github
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                
                <li>
                  <a href="/mosaic/get_in_contact/" title="Contact &amp; Mailing list" >
                    
                      Contact & Mailing list
                    
                    
                  </a>
                </li>
              
            
          </ul>
        
      </div>
    
  
    
      <div class="col-sm-4 mb-3 mb-md-0">
        <b>Eclipse Foundation</b>
        
          <ul>
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://www.eclipse.org/" title="About Eclipse Foundation"  target="_blank" rel="noopener">
                    
                      About Eclipse Foundation
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://www.eclipse.org/legal/privacy.php" title="Privacy Policy"  target="_blank" rel="noopener">
                    
                      Privacy Policy
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://www.eclipse.org/legal/termsofuse.php" title="Website terms of use"  target="_blank" rel="noopener">
                    
                      Website terms of use
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://www.eclipse.org/legal/copyright.php" title="Copyright"  target="_blank" rel="noopener">
                    
                      Copyright
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
              
                
                
                
                  
                    
                    
                  
                
                <li>
                  <a href="https://www.eclipse.org/legal" title="Legal"  target="_blank" rel="noopener">
                    
                      Legal
                    
                    
                      <i class="fa fa-external-link-alt" aria-hidden="true"></i>
                    
                  </a>
                </li>
              
            
          </ul>
        
      </div>
    
  











  </div>
  <div class="row justify-content-center mt-3 position-relative">
    <p class="powered-by text-center font-italic mb-0 pb-0">
      Powered by the
      <a href="https://themes.gohugo.io/themes/starter-hugo-academic" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.
      <br>
      Header image &#169; fanjianhua/ iStock
      <br>
      Website built on 23 Jul 2025, 14:50 UTC
    </p>
    
      <span class="position-absolute mr-3 mr-md-0" aria-hidden="true" style="right: 0;">
        <a href="#" class="back-to-top">
          <span class="button_icon">
            <i class="fas fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>
    
  </div>
</footer>


<script>
  var _paq = window._paq = window._paq || [];
   
  _paq.push(["setExcludedQueryParams", ["debug","dry","clean","nomaster"]]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://www.dcaiti.tu-berlin.de/m/";
    _paq.push(['setTrackerUrl', u+'m.php']);
    _paq.push(['setSiteId', 'm4o1kOykpy']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'m.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://www.dcaiti.tu-berlin.de/m/m.php?idsite=m4o1kOykpy&amp;rec=1" style="border:0;display:none;" alt="" />



    </div>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
